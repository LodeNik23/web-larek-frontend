# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# БАЗОВЫЙ КОД:

## Класс "Api"
Отправляет и принимает данные с сервера.
```
constructor - приниамет базовый адрес и данные для запросов,
handleResponse - проверяет ответ сервера, может вернуть ошибку или данные
get - получает данные
post - отправляет данные
```

## Класс "EventEmitter"
```
В работе данного приложения используется паттерн Observer.
При изменении состояния источника все наблюдатели автоматически об этом оповещаются.
```
```
Класс обеспечивает работу событий. Его функции: возможность установить и снять слушателей событий, 
вызвать слушателей при возникновении события».

"on"/"off" - Установить/Снять обработчик на событие, 
"emit" - Инициировать событие с данными, 
"onAll" - Слушать все события, 
"offAll" - Сбросить все обработчики, 
"trigger" - Сделать коллбек триггер, генерирующий событие при вызове
```
## Класс "Components"
Базовый класс для работы с DOM
```
"toggleClass(element: HTMLElement, className: string, force?: boolean)" - Переключить класс. 
Принимает элемент, строку с названием класса и доп.параметр с булевым значением.    

"setText(element: HTMLElement, value: unknown)" - Установить текстовое содержимое. 
Принимает элемент и строку с текстом.

"setDisabled(element: HTMLElement, state: boolean)" - Сменить статус блокировки. 
Принимает элемент и булево значение (true/false).

"setHidden(element: HTMLElement)" - Скрыть элемент. 
Работает с HTMLElement.

"setVisible(element: HTMLElement)" - Показать элемент. 
Работает с HTMLElement.

"setImage(element: HTMLImageElement, src: string, alt?: string)" - Установить изображение с альтернативным текстом. 
Принимает элемент, строку с URL изображения и строку с альтернативным текстом.

"render(data?: Partial<T>): HTMLElement " - Вернуть корневой DOM-элемент. 
Принимает аргумент data, который может содержать только часть полей и методов, определенных в типе `T`.   
```
## Класс "Model"
Базовый абстрактный класс для всех данных для взаимодействия с событиями
```
Принимает аргумент "events" и данные модели Partial<T>.
"emitChanges" - Сообщить всем что модель поменялась 
```


# ОПИСАНИЕ ДАННЫХ:

## Данные карточки "IProductItem"
```
"id" - карточки товара
"description" - описание товара
"image"- изображение товара
"title" - название товара
"category" - категория товара
"price" - цена товара
```
## Данные об оплате и доставке "IDelivery"
```
"payment" - Способ оплаты
"address" - Адреса доставки
```

## Данные контактные "IContacts"
```
"email" - Почта
"phone" - Контактный телефон
```

## Хранение данных "IAppState"
```
"catalog" - хранит карточки от GET
"basket" - хранит выбранные товары в корзине
"preview" - хранит предпросмотр карточки
"order" - хранит сбор данных для POST
"total" - хранение суммы заказа   
"items" - хранение id выбранных товаров

```
## "FormErrors" - хранит ошибки
```
```

## Данные заказа "IOrder"
```
"IDelivery", "IContacts"
"total" - общая сумма   
"items" - позиции добавлены
```

## Данные заказа ответные"IOrderResult"
```
"id" - id 
"total" - сумма заказа
```
## Данные карточки ICard
```
"IProductItem"
titleBtn - текст кнопки
index - порядковый номер 
```
## Данные действия при нажатии ICardActions
```
onClick - событие нажатия
```
## Данные валидации IFormState
```
valid - верно или нет заполнено поле
errors - ошибки
```
## Данные Корзины
```
items - позиции
total - общаяя сумма
selected - выбор кнопки
```

## Ошибки "FormErrors"


# ОТОБРАЖЕНИЕ (Model): 

## Хранение данных "AppState" 
```
Компонент модели данных для хранения актуальных данных приложения.
Использует данные "IAppState"
```
```
"setPreview" - превью товара
"setItems" - отобразить каталог
"addItem" - добавить товар в корзину
"removeItem" - удалить товар из корзины
"updateBusket" - обновить корзину
"cleanBuscet" - очистить корзину
"cleanOrder" - очистить заказ
"setDelivery" - принять данные о доставке
"validationDelivery" - проверить данные о доставке
"setContacts" - принять данные контактов
"validationContacts" - проверить данные контактов

"getTotal" - получить общую сумму заказа 
validationContacts и validationDelivery - шаблоны валидации

"PayChange" - выбор способа оплаты.
```

## Класс "LarekApi" - логика  
```
Дополняет функционал к базовому API от которого наследуется. Позволяет работать с сервером. 
Получает массив товаров с характеристиками, позволяет оформить заказ.
Инициализирует свойства и cdn, baseUrl, options и осуществляет запросы к серверу.
```
```
"getProductList"- Получить данные списока с сервера
"getProductItem" - Получить данные конкретного товара по id
"orderProduct" - Отправить данные покупки и получить ответ.
```

# ОТОБРАЖЕНИЕ(View): 

## 1. Объект "Modal"
```
Класс modal со своим интерфейсом наследуется от базового Component.
Отображает компонент - модальное окно, загружает его содержимое и управляет им.
Принимает элемент и объекты управления.
```
##  Действия
```
Устанавливает содержимое
Отображает содержимое
Открывается
Закрывается
```
```
_content - HTML-элемент - контент
_closeButton - HTML-элемент - кнопка
```
```
Конструктор принимает элемент container типа HTMLElement и объект events типа IEvents. 
Выполняет инициализацию контента и кнопки, 
добавляет обработчики на кнопки закрытия и контейнера модального окна.
```

# 2. Объект "Basket"
```
Класс basket со своим интерфейсом наследуется от базового Component.
Отображает компонент - корзина, загружает его содержимое и управляет им.
```
##  Действия
```
Устанавливает товары
Вкл/выкл кнопки оформления
Отображает общую стоимость
```
```
_list - HTML-элемент - список товаров в корзине
_total - HTML-элемент - общая стоимость
_button - HTML-элемент - кнопка
```
```
Конструктор принимает container типа HTMLElement и объект events типа EventEmitter. 
Выполняет инициализацию объекта `Basket`, находит необходимые элементы в DOM, добавляет 
обработчик события на кнопку и устанавливает начальные значения для свойств.
```

# 3. Объект "Form"
```
Класс Form<T> со своим интерфейсом наследуется от базового Component.
Отображает компонент - формы, реализует взаимодействие с пользователем.
Получает форму и объект управления
```
##  Действия
```
Отображает форму
Вкл/выкл кнопки отправки формы
Выводит ошибки
```
```
_submit - HTML-элемент - кнопка
_errors - HTML-элемент - ошибки
```
```
Конструктор принимает элемент container типа HTMLElement и объект events типа IEvents.  
Выполняет инициализацию элементов формы: кнопки отправки и блока для отображения ошибок. 
Добавляются обработчики событий на ввод данных и отправку формы. 
```

# 4. Объект "Success"
```
Класс success со своим интерфейсом наследуется от базового Component.
Отображает итоговый компонент в цепочке заказа с выводом необходимых данных. 
Получает элемент, объект управления
```
##  Действия
```
Отображает элемент
Отображает стоимость заказа
```
```
накидывает обработчик
_close - HTML-элемент - кнопка
_total - HTML-элемент - общая стоимость
```
```
Конструктор принимает элемент container типа HTMLElement и объект events типа IEvents. 
Выполняет инициализацию элементов _close и _total. Если переданы действия actions и 
определено свойство onClick, то к элементу _close добавляется обработчик события click, 
который вызывает функцию onClick.
```
# 5. Объект "Page"
```
Класс page  - компонент страницы, который управляет отображением счетчика, каталога товаров, блока страницы.
```

##  Действия
```
Обновляет счетчик
Обновляет каталог
Управляет блокировкой страницы
```
```
_counter - HTML-элемент - счетчик
_catalog - HTML-элемент - каталог
_wrapper - HTML-элемент - обертка страницы
_basket - HTML-элемент - корзина
```
```
Конструктор принимает элемент container типа HTMLElement и объект events типа IEvent. 
Выполняет инициализацию элементов счетчика, каталога,обертки и корзины. Устанавливается обработчик события клика 
на элемент корзины, который при клике генерирует событие.
```

# 6. Объект "Card"
```
Класс Card со своим интерфейсом наследуется от базового Component.
Отображает данные о товаре. Может отключить кнопку.
```

##  Действия
```
Отключает кнопку цены, если значение "null"
Устанавливает ID карты
Получает ID карты
Устанавливает название карты
Получает ID карты
Устанавливает цену карты
Получает цену карты
Устанавливает категорию карты и применяет соответствующий класс-стилей
Получает категорию карты
Устанавливает индекс карты
Получает индекс карты
Устанавливает изображение карты
Устанавливает описание карты
Устанавливает название карты
```
```
_title - HTML-элемент - название товара
_price - HTML-элемент - 
_image - HTML-элемент - изображение товара
_description - HTML-элемент - описание товара
_category - HTML-элемент - категория товара
_button - HTML-элемент - кнопка
_index - индекс карточки(?)
```
```
Конструктор принимает элемент container типа HTMLElement и объект events типа IEvents.
Выполняет инициализацию карточки товара.
```

Приложение состоит из компонентов, которые отвечают за отображение данных и за их хранение, работающих с базовым кодом.